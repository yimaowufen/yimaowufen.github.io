<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡ç—‡åŒ»å­¦ç§‘ä¹‹æŒç»­è‚¾è„æ›¿ä»£æ²»ç–—ç³»åˆ—</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'Arial', sans-serif;
        }
        body {
            background-color: #f0f8fb; /* æŸ”å’ŒåŒ»ç–—èƒŒæ™¯è‰² */
            color: #333;
            line-height: 1.6;
            overflow-x: hidden; /* ç¦æ­¢æ¨ªå‘æ»šåŠ¨ */
        }
        /* è¡¨å¤´æ ¸å¿ƒä¼˜åŒ–ï¼š */
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 12px 15px;
            display: flex;
            align-items: flex-end; /* æ•´ä½“å‚ç›´é ä¸‹å¯¹é½ */
            justify-content: space-between; /* ä¸¤ç«¯å¯¹é½ */
            flex-wrap: nowrap; /* ç¦æ­¢æ¢è¡Œ */
            gap: 12px; /* LOGOä¸æ ‡é¢˜é—´è· */
            min-height: 70px; /* å›ºå®šè¡¨å¤´æœ€å°é«˜åº¦ */
        }
        .logo {
            width: 50px;
            height: 50px;
            background-color: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            flex-shrink: 0; /* LOGOä¸å‹ç¼© */
            margin-bottom: 2px; /* å¾®è°ƒLOGOä½ç½® */
        }
        /* æ ‡é¢˜å®¹å™¨ï¼šå‚ç›´å±…ä¸­ */
        .title-container {
            display: flex;
            flex-direction: column;
            justify-content: center; /* æ ‡é¢˜è‡ªèº«å‚ç›´å±…ä¸­ */
            flex: 1; /* å æ»¡ä¸­é—´ç©ºé—´ */
            min-width: 0; /* å…è®¸æ–‡å­—æº¢å‡ºçœç•¥ */
        }
        .main-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .sub-title {
            font-size: 12px;
            opacity: 0.9;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        /* é å³+ç´§è´´è¡¨å¤´åº•éƒ¨ */
        .acknowledgement {
            display: flex;
            flex-direction: column;
            align-items: flex-end; /* æ–‡å­—å³å¯¹é½ */
            min-width: 150px; /* å›ºå®šæœ€å°å®½åº¦ */
            font-size: 11px;
            padding: 0;
            margin: 0;
            margin-bottom: 2px; /* ç´§è´´è¡¨å¤´åº•éƒ¨ï¼Œ2pxé—´è· */
        }
        .designer {
            margin-top: 1px; /* ç¼©å°è¡Œé—´è·ï¼Œæ›´ç´§å‡‘é ä¸‹ */
            white-space: nowrap;
        }
        .container {
            max-width: 100%;
            margin: 15px auto;
            padding: 0 15px;
        }
        .patient-info, .function-module {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow: visible;
        }
        .section-title {
            font-size: 16px;
            color: #2c3e50;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3498db;
        }
        .form-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 12px;
        }
        .form-item {
            flex: 1;
            min-width: 140px;
            display: flex;
            flex-direction: column;
        }
        label {
            font-weight: 500;
            margin-bottom: 4px;
            color: #444;
            font-size: 13px;
        }
        input, select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            transition: border-color 0.3s;
            width: 100%;
        }
        /* å¯ç”¨åŸç”Ÿä¸‹æ‹‰æ¡† */
        select {
            background-color: white;
            appearance: menulist;
            -webkit-appearance: menulist;
            -moz-appearance: menulist;
            border: 1px solid #ddd;
            padding-right: 25px;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        .table-container {
            overflow-x: auto;
            margin: 12px 0;
            padding: 5px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            word-break: break-all;
        }
        th {
            background-color: #f8f9fa;
            color: #2c3e50;
            font-weight: 600;
        }
        .result-card {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 12px;
            margin: 12px 0;
            border-radius: 4px;
            font-size: 13px;
        }
        .result-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 14px;
        }
        .result-content {
            line-height: 1.7;
        }
        .alert {
            padding: 8px;
            margin: 8px 0;
            border-radius: 4px;
            font-size: 12px;
        }
        .alert-info {
            background-color: #e3f2fd;
            color: #1976d2;
            border: 1px solid #bbdefb;
        }
        .btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        .btn:hover {
            background-color: #2980b9;
        }
        .btn-reset {
            background-color: #95a5a6;
        }
        .btn-reset:hover {
            background-color: #7f8c8d;
        }
        /* åŠŸèƒ½å››ä¸“å±æ ·å¼ï¼ˆåŒ¹é…æ•´ä½“é£æ ¼ï¼‰ */
        .result {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 12px;
            margin: 12px 0;
            border-radius: 4px;
            font-size: 13px;
            line-height: 1.7;
        }
        /* ç§»åŠ¨ç«¯é€‚é…ï¼š */
        @media (max-width: 768px) {
            .header {
                padding: 10px 12px;
                gap: 8px;
                align-items: flex-end; /* ä¿æŒå‚ç›´é ä¸‹ */
                min-height: 65px;
            }
            .logo {
                width: 45px;
                height: 45px;
                font-size: 20px;
                margin-bottom: 1px;
            }
            .main-title {
                font-size: 15px;
            }
            .sub-title {
                font-size: 11px;
            }
            .acknowledgement {
                min-width: 120px;
                font-size: 10px;
                margin-bottom: 1px; /* ç§»åŠ¨ç«¯ç´§è´´åº•éƒ¨ */
                margin-left: auto; /* å¼ºåˆ¶é å³ */
            }
            .designer {
                margin-top: 1px;
            }
        }
        /* è¶…å°å±é€‚é… */
        @media (max-width: 375px) {
            .acknowledgement {
                min-width: auto;
                max-width: 120px;
                font-size: 9px; /* ç¼©å°å­—ä½“ï¼Œé¿å…æ¢è¡Œ */
            }
            .main-title {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- å¤´éƒ¨åŒºåŸŸï¼šLOGOé å·¦ + æ ‡é¢˜ç´§è·Ÿ + é¸£è°¢é å³ä¸”è´´è¿‘è¡¨å¤´ä¸‹æ–¹ -->
    <div class="header">
        <div class="logo">ğŸ¥</div> <!-- LOGOé å·¦ï¼Œå¾®è°ƒä½ç½®ä¸é¸£è°¢å¯¹é½ -->
        <div class="title-container"> <!-- æ ‡é¢˜è‡ªèº«å‚ç›´å±…ä¸­ -->
            <div class="main-title">å¦‚çš‹å¸‚äººæ°‘åŒ»é™¢--é‡ç—‡åŒ»å­¦ç§‘</div>
            <div class="sub-title">æŒç»­è‚¾è„æ›¿ä»£æ²»ç–—ç³»åˆ—</div>
        </div>
        <div class="acknowledgement"> <!-- ç´§è´´è¡¨å¤´åº•éƒ¨ -->
           <div class="designer">Designer: ä¸€æ¯›äº”åˆ†</div>
        </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="container">
        <!-- æ‚£è€…åŸºæœ¬ä¿¡æ¯ -->
        <div class="patient-info">
            <div class="section-title">æ‚£è€…åŸºæœ¬ä¿¡æ¯</div>
            <div class="form-group">
                <div class="form-item">
                    <label for="age">å¹´é¾„ï¼ˆå²ï¼‰</label>
                    <input type="number" id="age" min="0" max="120" placeholder="è¯·è¾“å…¥å¹´é¾„">
                </div>
                <div class="form-item">
                    <label for="gender">æ€§åˆ«</label>
                    <select id="gender">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="male">ç”·</option>
                        <option value="female">å¥³</option>
                    </select>
                </div>
                <div class="form-item">
                    <label for="weight">ä½“é‡ï¼ˆkgï¼‰</label>
                    <input type="number" id="weight" min="0" max="200" step="0.1" placeholder="è¯·è¾“å…¥ä½“é‡">
                </div>
                <div class="form-item">
                    <label for="hct">çº¢ç»†èƒå‹ç§¯ï¼ˆ%ï¼‰</label>
                    <input type="number" id="hct" min="0" max="100" step="0.1" placeholder="è¯·è¾“å…¥çº¢ç»†èƒå‹ç§¯">
                </div>
            </div>
        </div>

        <!-- åŠŸèƒ½ä¸€ï¼šAKIåˆ†çº§è¯Šæ–­ -->
        <div class="function-module">
            <div class="section-title">åŠŸèƒ½ä¸€ï¼šAKIåˆ†çº§è¯Šæ–­ï¼ˆKDIGOæ ‡å‡†ï¼‰</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>AKIåˆ†çº§</th>
                            <th>è¡€æ¸…è‚Œé…ï¼ˆScrï¼‰æ ‡å‡†</th>
                            <th>å°¿é‡æ ‡å‡†ï¼ˆæ’é™¤è„±æ°´/æ¢—é˜»ç­‰å› ç´ ï¼‰</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1çº§</td>
                            <td>SCrå‡é«˜è‡³åŸºçº¿å€¼çš„1.5-1.9å€ï¼Œæˆ–ç»å¯¹å€¼å¢åŠ â‰¥26.5Î¼mol/L</td>
                            <td>å°¿é‡<0.5ml/(kgÂ·h)ï¼ŒæŒç»­6-12å°æ—¶</td>
                        </tr>
                        <tr>
                            <td>2çº§</td>
                            <td>SCrå‡é«˜è‡³åŸºçº¿å€¼çš„2.0-2.9å€</td>
                            <td>å°¿é‡<0.5ml/(kgÂ·h)ï¼ŒæŒç»­â‰¥12å°æ—¶</td>
                        </tr>
                        <tr>
                            <td>3çº§</td>
                            <td>SCrå‡é«˜è‡³åŸºçº¿å€¼çš„3.0å€æˆ–ä»¥ä¸Šï¼Œæˆ–SCrâ‰¥353.6Î¼mol/Lï¼Œæˆ–å¼€å§‹è‚¾è„æ›¿ä»£æ²»ç–—</td>
                            <td>å°¿é‡<0.3ml/(kgÂ·h)ï¼ŒæŒç»­â‰¥24å°æ—¶ï¼›æˆ–æ— å°¿æŒç»­â‰¥12å°æ—¶</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="form-group">
                <div class="form-item">
                    <label for="scr-baseline">è‚Œé…åŸºçº¿å€¼ï¼ˆÎ¼mol/Lï¼‰</label>
                    <input type="number" id="scr-baseline" min="0" step="0.1" placeholder="è¯·è¾“å…¥åŸºçº¿è‚Œé…">
                </div>
                <div class="form-item">
                    <label for="scr-monitor">ç›‘æµ‹è‚Œé…å€¼ï¼ˆÎ¼mol/Lï¼‰</label>
                    <input type="number" id="scr-monitor" min="0" step="0.1" placeholder="è¯·è¾“å…¥ç›‘æµ‹è‚Œé…">
                </div>
                <div class="form-item">
                    <label for="urine-time">å°¿é‡æŒç»­æ—¶é—´ï¼ˆå°æ—¶ï¼‰</label>
                    <input type="number" id="urine-time" min="0" step="0.1" placeholder="è¯·è¾“å…¥æŒç»­æ—¶é—´">
                </div>
                <div class="form-item">
                    <label for="urine-volume">æ€»å°¿é‡ï¼ˆmlï¼‰</label>
                    <input type="number" id="urine-volume" min="0" step="0.1" placeholder="è¯·è¾“å…¥æ€»å°¿é‡">
                </div>
            </div>
            <button class="btn" onclick="calculateAKI()">è®¡ç®—AKIåˆ†çº§</button>
            <button class="btn btn-reset" onclick="resetAKI()">é‡ç½®</button>
            <div class="result-card" id="aki-result" style="display: none;">
                <div class="result-title">è®¡ç®—ç»“æœ</div>
                <div class="result-content" id="aki-result-content"></div>
            </div>
        </div>

        <!-- åŠŸèƒ½äºŒï¼šCRRTç½®æ¢æ¶²é…æ–¹è®¡ç®— -->
        <div class="function-module">
            <div class="section-title">åŠŸèƒ½äºŒï¼šCRRTç½®æ¢æ¶²é…æ–¹è®¡ç®—</div>
            <div class="alert alert-info">
                æç¤ºï¼šæ³¨æ„ç½®æ¢æ¶²å„æˆåˆ†çš„å®é™…æµ“åº¦ï¼ˆ%ï¼‰ï¼Œå¦‚ä¸è®¾ç½®å€¼ä¸ç¬¦ï¼Œè¯·æ¢ç®—åè¾“å…¥ï¼
            </div>
            <div class="form-group">
                <div class="form-item">
                    <label for="nacl-09">0.9%æ°¯åŒ–é’ ï¼ˆmlï¼‰</label>
                    <input type="number" id="nacl-09" min="0" step="1" placeholder="è¯·è¾“å…¥ç”¨é‡">
                </div>
                <div class="form-item">
                    <label for="water">ç­èŒæ³¨å°„ç”¨æ°´ï¼ˆmlï¼‰</label>
                    <input type="number" id="water" min="0" step="1" placeholder="è¯·è¾“å…¥ç”¨é‡">
                </div>
                <div class="form-item">
                    <label for="kcl-10">10%æ°¯åŒ–é’¾ï¼ˆmlï¼‰</label>
                    <input type="number" id="kcl-10" min="0" step="0.1" placeholder="è¯·è¾“å…¥ç”¨é‡">
                </div>
                <div class="form-item">
                    <label for="nacl-10">10%æ°¯åŒ–é’ ï¼ˆmlï¼‰</label>
                    <input type="number" id="nacl-10" min="0" step="0.1" placeholder="è¯·è¾“å…¥ç”¨é‡">
                </div>
            </div>
            <div class="form-group">
                <div class="form-item">
                    <label for="nahco3-5">5%ç¢³é…¸æ°¢é’ ï¼ˆmlï¼‰</label>
                    <input type="number" id="nahco3-5" min="0" step="1" placeholder="è¯·è¾“å…¥ç”¨é‡">
                </div>
                <div class="form-item">
                    <label for="ca-gluconate-10">10%è‘¡è„ç³–é…¸é’™ï¼ˆmlï¼‰</label>
                    <input type="number" id="ca-gluconate-10" min="0" step="0.1" placeholder="è¯·è¾“å…¥ç”¨é‡">
                </div>
                <div class="form-item">
                    <label for="mgso4-25">25%MgSOâ‚„Â·7Hâ‚‚Oï¼ˆmlï¼‰</label>
                    <input type="number" id="mgso4-25" min="0" step="0.1" placeholder="è¯·è¾“å…¥ç”¨é‡">
                </div>
                <div class="form-item">
                    <label for="glucose-50">50%è‘¡è„ç³–ï¼ˆmlï¼‰</label>
                    <input type="number" id="glucose-50" min="0" step="0.1" placeholder="è¯·è¾“å…¥ç”¨é‡">
                </div>
            </div>
            <button class="btn" onclick="calculateReplacement()">è®¡ç®—ç½®æ¢æ¶²å‚æ•°</button>
            <button class="btn btn-reset" onclick="resetReplacement()">é‡ç½®</button>
            <div class="result-card" id="replacement-result" style="display: none;">
                <div class="result-title">ç½®æ¢æ¶²è®¡ç®—ç»“æœ</div>
                <div class="result-content" id="replacement-result-content"></div>
            </div>
        </div>

        <!-- åŠŸèƒ½ä¸‰ï¼šCRRTå¤„æ–¹å‚æ•°è®¡ç®— -->
        <div class="function-module">
            <div class="section-title">åŠŸèƒ½ä¸‰ï¼šCRRTå¤„æ–¹å‚æ•°è®¡ç®—</div>
            <div class="form-group">
                <div class="form-item">
                    <label for="crrt-mode">CRRTæ¨¡å¼</label>
                    <select id="crrt-mode">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="CVVH">CVVHï¼ˆè¿ç»­æ€§é™è„‰-é™è„‰è¡€æ¶²æ»¤è¿‡ï¼‰</option>
                        <option value="CVVHD">CVVHDï¼ˆè¿ç»­æ€§é™è„‰-é™è„‰è¡€æ¶²é€æï¼‰</option>
                        <option value="CVVHDF">CVVHDFï¼ˆè¿ç»­æ€§é™è„‰-é™è„‰è¡€æ¶²é€ææ»¤è¿‡ï¼‰</option>
                        <option value="SCUF">SCUFï¼ˆç¼“æ…¢è¿ç»­æ€§è¶…æ»¤ï¼‰</option>
                    </select>
                </div>
                <div class="form-item">
                    <label for="blood-flow">è¡€æµé€Ÿï¼ˆml/minï¼‰</label>
                    <input type="number" id="blood-flow" min="0" step="1" placeholder="è¯·è¾“å…¥è¡€æµé€Ÿ">
                </div>
                <div class="form-item">
                    <label for="pre-dilution">å‰ç¨€é‡Šç”¨é‡ï¼ˆml/hï¼‰</label>
                    <input type="number" id="pre-dilution" min="0" step="1" placeholder="è¯·è¾“å…¥å‰ç¨€é‡Šç”¨é‡">
                </div>
                <div class="form-item">
                    <label for="post-dilution">åç¨€é‡Šç”¨é‡ï¼ˆml/hï¼‰</label>
                    <input type="number" id="post-dilution" min="0" step="1" placeholder="è¯·è¾“å…¥åç¨€é‡Šç”¨é‡">
                </div>
            </div>
            <div class="form-group">
                <div class="form-item">
                    <label for="dialysate-flow">é€ææ¶²ç”¨é‡ï¼ˆml/hï¼‰</label>
                    <input type="number" id="dialysate-flow" min="0" step="1" placeholder="è¯·è¾“å…¥é€ææ¶²ç”¨é‡">
                </div>
                <div class="form-item">
                    <label for="fluid-balance">æ¶²ä½“å¹³è¡¡ï¼ˆmlï¼‰</label>
                    <input type="number" id="fluid-balance" step="1" placeholder="æ­£å¹³è¡¡ä¸ºæ­£ï¼Œè´Ÿå¹³è¡¡ä¸ºè´Ÿ">
                </div>
            </div>
            <div class="alert alert-info">
                å‚è€ƒæ ‡å‡†ï¼šè‚¾è„æ›¿ä»£è¶…æ»¤ç‡ï¼š20-25ml/kg/hï¼Œé‡ç—‡æ‚£è€…è¶…æ»¤ç‡ï¼š30-35ml/kg/hï¼Œé‡ç—‡æ„ŸæŸ“è¶…æ»¤ç‡ï¼š40ml/kg/hï¼Œæ»¤è¿‡åˆ†æ•°ï¼œ30%
            </div>
            <button class="btn" onclick="calculateCRRTParams()">è®¡ç®—UFRå’ŒFF</button>
            <button class="btn btn-reset" onclick="resetCRRTParams()">é‡ç½®</button>
            <div class="result-card" id="crrt-params-result" style="display: none;">
                <div class="result-title">CRRTå‚æ•°è®¡ç®—ç»“æœ</div>
                <div class="result-content" id="crrt-params-result-content"></div>
            </div>
        </div>

        <!-- åŠŸèƒ½å››ï¼šCRRTå¤„æ–¹ä¼˜åŒ–è®¡ç®— -->
        <div class="function-module">
            <div class="section-title">åŠŸèƒ½å››ï¼šCRRTå¤„æ–¹ä¼˜åŒ–è®¡ç®—</div>
            <div class="form-group">
                <div class="form-item">
                    <label for="target-ufr">ç›®æ ‡è¶…æ»¤ç‡ï¼ˆml/kg/hï¼‰</label>
                    <input type="number" id="target-ufr" min="0" step="0.1" placeholder="è¯·è¾“å…¥ç›®æ ‡UFR">
                </div>
                <div class="form-item">
                    <label for="total-replacement">ç½®æ¢æ¶²æ€»é‡ï¼ˆml/hï¼‰</label>
                    <input type="number" id="total-replacement" min="0" step="1" placeholder="å‰ç¨€é‡Š+åç¨€é‡Šæ€»é‡">
                </div>
                <div class="form-item">
                    <label for="blood-flow-opt">è¡€æµé€Ÿï¼ˆml/minï¼‰</label>
                    <input type="number" id="blood-flow-opt" min="0" step="1" placeholder="è¯·è¾“å…¥è¡€æµé€Ÿ">
                </div>
                <div class="form-item">
                    <label for="fluid-balance-opt">æ¶²ä½“å¹³è¡¡ï¼ˆml/hï¼‰</label>
                    <input type="number" id="fluid-balance-opt" step="1" placeholder="æ­£å¹³è¡¡ä¸ºæ­£ï¼Œè´Ÿå¹³è¡¡ä¸ºè´Ÿ">
                </div>
            </div>
            <button class="btn" onclick="optimizeCRRT()">è®¡ç®—ä¼˜åŒ–å¤„æ–¹</button>
            <button class="btn btn-reset" onclick="resetOptimizeCRRT()">é‡ç½®</button>
            <div class="result-card" id="optimize-result" style="display: none;">
                <div class="result-title">CRRTå¤„æ–¹ä¼˜åŒ–ç»“æœ</div>
                <div class="result-content" id="optimize-result-content"></div>
            </div>
        </div>
    </div>

    <script>
        // è·å–è¾“å…¥å€¼ï¼ˆå¤„ç†ç©ºå€¼ï¼‰
        function getInputValue(id) {
            const value = document.getElementById(id).value.trim();
            return value ? parseFloat(value) : null;
        }

        // åŠŸèƒ½ä¸€ï¼šAKIåˆ†çº§è®¡ç®—
        function calculateAKI() {
            const scrBaseline = getInputValue('scr-baseline');
            const scrMonitor = getInputValue('scr-monitor');
            const urineTime = getInputValue('urine-time');
            const urineVolume = getInputValue('urine-volume');
            const weight = getInputValue('weight');
            const age = getInputValue('age');
            const gender = document.getElementById('gender').value;
            const resultEl = document.getElementById('aki-result');
            const contentEl = document.getElementById('aki-result-content');

            if (!scrBaseline || !scrMonitor || !urineTime || !urineVolume || !weight || !age || !gender) {
                contentEl.innerHTML = 'è¯·å®Œå–„æ‰€æœ‰è¾“å…¥å‚æ•°ï¼';
                resultEl.style.display = 'block';
                return;
            }

            // åˆ†çº§é€»è¾‘ï¼šæŒ‰KDIGOæ ‡å‡†ï¼Œ"æˆ–"å…³ç³»ç‹¬ç«‹åˆ¤å®š
            const scrRatio = scrMonitor / scrBaseline;
            const scrIncrease = scrMonitor - scrBaseline;
            let scrGrade = 'æ— ';
            if (scrRatio >= 3.0 || scrMonitor >= 353.6) {
                scrGrade = '3çº§'; // 3å€ä»¥ä¸Šæˆ–â‰¥353.6Î¼mol/L â†’ 3çº§
            } else if (scrRatio >= 2.0 && scrRatio < 3.0) {
                scrGrade = '2çº§'; // 2.0-2.9å€ â†’ 2çº§
            } else if (scrRatio >= 1.5 && scrRatio < 2.0 || scrIncrease >= 26.5) {
                scrGrade = '1çº§'; // 1.5-1.9å€ æˆ– ç»å¯¹å€¼â‰¥26.5Î¼mol/L â†’ 1çº§ï¼ˆæˆ–å…³ç³»ï¼‰
            }

            const urineRate = urineVolume / (weight * urineTime);
            let urineGrade = 'æ— ';
            if (urineRate < 0.5 && urineTime >= 6 && urineTime < 12) urineGrade = '1çº§';
            else if (urineRate < 0.5 && urineTime >= 12) urineGrade = '2çº§';
            else if ((urineRate < 0.3 && urineTime >= 24) || (urineVolume === 0 && urineTime >= 12)) urineGrade = '3çº§';

            // åˆ†çº§åˆ¤å®š
            let finalGrade;
            if (scrGrade === 'æ— ' && urineGrade === 'æ— ') {
                finalGrade = 'æœªè¾¾åˆ°AKIè¯Šæ–­æ ‡å‡†';
            } else if (scrGrade === 'æ— ') {
                finalGrade = urineGrade;
            } else if (urineGrade === 'æ— ') {
                finalGrade = scrGrade;
            } else {
                const gradeMap = { '1çº§': 1, '2çº§': 2, '3çº§': 3 };
                finalGrade = gradeMap[scrGrade] >= gradeMap[urineGrade] ? scrGrade : urineGrade;
            }

            // è‚Œé…æ¸…é™¤ç‡è®¡ç®—ï¼ˆä¸´åºŠå¸¸ç”¨Cockcroft-Gaultå…¬å¼ï¼Œè‚Œé…å•ä½Î¼mol/Lè½¬æ¢ä¸ºmg/dLï¼‰
            const scrMgDl = scrMonitor / 88.4; // Î¼mol/L â†’ mg/dLï¼ˆ1mg/dL=88.4Î¼mol/Lï¼‰
            let crCl;
            if (gender === 'male') {
                // ç”·æ€§ï¼šCRCL = (140 - å¹´é¾„) Ã— ä½“é‡(kg) / (72 Ã— è¡€è‚Œé…(mg/dL))
                crCl = (140 - age) * weight / (72 * scrMgDl);
            } else {
                // å¥³æ€§ï¼šCRCL = (140 - å¹´é¾„) Ã— ä½“é‡(kg) / (72 Ã— è¡€è‚Œé…(mg/dL)) Ã— 0.85
                crCl = (140 - age) * weight / (72 * scrMgDl) * 0.85;
            }
            crCl = crCl.toFixed(1); // ä¿ç•™1ä½å°æ•°

            // è¾“å‡ºç»“æœ
            let basis = `<p>1. è‚Œé…è¯„ä¼°ï¼šåŸºçº¿${scrBaseline}Î¼mol/Lï¼Œç›‘æµ‹${scrMonitor}Î¼mol/Lï¼Œä¸ºåŸºçº¿çš„${scrRatio.toFixed(2)}å€ï¼Œå¢åŠ ${scrIncrease.toFixed(1)}Î¼mol/L â†’ ç¬¦åˆ${scrGrade}æ ‡å‡†</p>`;
            basis += `<p>2. å°¿é‡è¯„ä¼°ï¼š${urineTime}å°æ—¶å°¿é‡${urineVolume}mlï¼Œå°¿é‡ç‡${urineRate.toFixed(2)}ml/(kgÂ·h) â†’ ç¬¦åˆ${urineGrade}æ ‡å‡†</p>`;
            basis += `<p>3. è‚Œé…æ¸…é™¤ç‡ï¼ˆCockcroft-Gaultå…¬å¼ï¼‰ï¼š${crCl} ml/min</p>`;
            basis += `<p><strong>æœ€ç»ˆAKIåˆ†çº§ï¼š${finalGrade}</strong>ï¼ˆKDIGOæ ‡å‡†ï¼‰</p>`;

            contentEl.innerHTML = basis;
            resultEl.style.display = 'block';
        }

        function resetAKI() {
            document.getElementById('scr-baseline').value = '';
            document.getElementById('scr-monitor').value = '';
            document.getElementById('urine-time').value = '';
            document.getElementById('urine-volume').value = '';
            document.getElementById('aki-result').style.display = 'none';
        }

        // åŠŸèƒ½äºŒï¼šç½®æ¢æ¶²é…æ–¹è®¡ç®—
        function calculateReplacement() {
            const nacl09 = getInputValue('nacl-09') || 0;
            const water = getInputValue('water') || 0;
            const kcl10 = getInputValue('kcl-10') || 0;
            const nacl10 = getInputValue('nacl-10') || 0;
            const nahco35 = getInputValue('nahco3-5') || 0;
            const caGluconate10 = getInputValue('ca-gluconate-10') || 0;
            const mgso425 = getInputValue('mgso4-25') || 0;
            const glucose50 = getInputValue('glucose-50') || 0;

            const resultEl = document.getElementById('replacement-result');
            const contentEl = document.getElementById('replacement-result-content');

            const totalVolume = (nacl09 + water + kcl10 + nacl10 + nahco35 + caGluconate10 + mgso425 + glucose50) / 1000;
            if (totalVolume === 0) {
                contentEl.innerHTML = 'è¯·è‡³å°‘è¾“å…¥ä¸€ç§æˆåˆ†çš„ç”¨é‡ï¼';
                resultEl.style.display = 'block';
                return;
            }

            const kclMass = kcl10 * 0.1;
            const nacl09Mass = nacl09 * 0.009;
            const nacl10Mass = nacl10 * 0.1;
            const nahco35Mass = nahco35 * 0.05;
            const mgso4Mass = mgso425 * 0.25;
            const glucoseMass = glucose50 * 0.5;

            const kConcentration = (kclMass * 13.4) / totalVolume;
            const naConcentration = (nacl09Mass * 17.1 + nacl10Mass * 17.1 + nahco35Mass * 11.9) / totalVolume;
            const caConcentration = (caGluconate10 * 0.1 * 2.25) / totalVolume;
            const mgConcentration = (mgso4Mass * 4.04) / totalVolume;
            const HCO3Concentration = (nahco35Mass * 11.9) / totalVolume;
            const glucoseConcentration = (glucoseMass * 5.56) / totalVolume;

            let result = `<p><strong>ç½®æ¢æ¶²æ€»ä½“ç§¯ï¼š${totalVolume.toFixed(2)} L</strong></p>`;
            result += `<p>ç¦»å­æµ“åº¦ï¼š</p>`;
            result += `<ul>`;
            result += `<li>é’ ç¦»å­ï¼š${naConcentration.toFixed(1)} mmol/L</li>`;
            result += `<li>é’¾ç¦»å­ï¼š${kConcentration.toFixed(1)} mmol/L</li>`;
            result += `<li>é’™ç¦»å­ï¼š${caConcentration.toFixed(1)} mmol/L</li>`;
            result += `<li>é•ç¦»å­ï¼š${mgConcentration.toFixed(1)} mmol/L</li>`;
            result += `<li>ç¢³é…¸æ°¢æ ¹ç¦»å­ï¼š${HCO3Concentration.toFixed(1)} mmol/L</li>`;
            result += `<li>è‘¡è„ç³–ï¼š${glucoseConcentration.toFixed(1)} mmol/L</li>`;
            result += `</ul>`;

            contentEl.innerHTML = result;
            resultEl.style.display = 'block';
        }

        function resetReplacement() {
            document.getElementById('nacl-09').value = '';
            document.getElementById('water').value = '';
            document.getElementById('kcl-10').value = '';
            document.getElementById('nacl-10').value = '';
            document.getElementById('nahco3-5').value = '';
            document.getElementById('ca-gluconate-10').value = '';
            document.getElementById('mgso4-25').value = '';
            document.getElementById('glucose-50').value = '';
            document.getElementById('replacement-result').style.display = 'none';
        }

        // åŠŸèƒ½ä¸‰ï¼šCRRTå¤„æ–¹å‚æ•°è®¡ç®—
        function calculateCRRTParams() {
            const bloodFlow = getInputValue('blood-flow');
            const preDilution = getInputValue('pre-dilution') || 0;
            const postDilution = getInputValue('post-dilution') || 0;
            const fluidBalance = getInputValue('fluid-balance') || 0;
            const hct = getInputValue('hct');
            const weight = getInputValue('weight');
            const resultEl = document.getElementById('crrt-params-result');
            const contentEl = document.getElementById('crrt-params-result-content');

            if (!bloodFlow || !hct || !weight) {
                contentEl.innerHTML = 'è¯·å®Œå–„è¡€æµé€Ÿã€çº¢ç»†èƒå‹ç§¯å’Œä½“é‡å‚æ•°ï¼';
                resultEl.style.display = 'block';
                return;
            }

            let ufr, ff;
            const plasmaFlow = bloodFlow * (1 - hct / 100);

            if (preDilution === 0) {
                const netUltrafiltration = postDilution - fluidBalance;
                ufr = netUltrafiltration / weight;
                ff = (netUltrafiltration) / (plasmaFlow * 60) * 100;
            } else {
                const A = plasmaFlow / (plasmaFlow + preDilution / 60);
                const netUltrafiltration = preDilution + postDilution - fluidBalance;
                ufr = (A * netUltrafiltration) / weight;
                ff = (postDilution - fluidBalance) / (plasmaFlow * 60) * 100;
            }

            let result = `<p><strong>è¶…æ»¤ç‡ï¼ˆUFRï¼‰ï¼š${ufr.toFixed(2)} ml/kg/h</strong></p>`;
            result += `<p><strong>æ»¤è¿‡åˆ†æ•°ï¼ˆFFï¼‰ï¼š${ff.toFixed(1)}%</strong></p>`;
            result += `<p>å‚è€ƒæ ‡å‡†ï¼šè‚¾è„æ›¿ä»£UFR 20-25ml/kg/hï¼Œé‡ç—‡30-35ml/kg/hï¼Œé‡ç—‡æ„ŸæŸ“40ml/kg/hï¼ŒFFï¼œ30%</p>`;
            if (ff >= 30) {
                result += `<p style="color: #e74c3c; font-weight: bold;">âš ï¸ è­¦å‘Šï¼šæ»¤è¿‡åˆ†æ•°â‰¥30%ï¼Œå»ºè®®è°ƒæ•´å¤„æ–¹ï¼</p>`;
            }

            contentEl.innerHTML = result;
            resultEl.style.display = 'block';
        }

        function resetCRRTParams() {
            document.getElementById('crrt-mode').value = '';
            document.getElementById('blood-flow').value = '';
            document.getElementById('pre-dilution').value = '';
            document.getElementById('post-dilution').value = '';
            document.getElementById('dialysate-flow').value = '';
            document.getElementById('fluid-balance').value = '';
            document.getElementById('crrt-params-result').style.display = 'none';
        }

        // åŠŸèƒ½å››ï¼šCRRTå¤„æ–¹ä¼˜åŒ–è®¡ç®—
        function optimizeCRRT() {
            const targetUFR = getInputValue('target-ufr');
            const totalReplacement = getInputValue('total-replacement');
            const bloodFlowOpt = getInputValue('blood-flow-opt');
            const fluidBalanceOpt = getInputValue('fluid-balance-opt') || 0;
            const hct = getInputValue('hct');
            const weight = getInputValue('weight');
            const resultEl = document.getElementById('optimize-result');
            const contentEl = document.getElementById('optimize-result-content');

            if (!targetUFR || !totalReplacement || !bloodFlowOpt || !hct || !weight) {
                contentEl.innerHTML = 'è¯·å®Œå–„æ‰€æœ‰è¾“å…¥å‚æ•°ï¼';
                resultEl.style.display = 'block';
                return;
            }

            const plasmaFlow = bloodFlowOpt * (1 - hct / 100);
           
            const targetNetUF = targetUFR * weight;
            let A = (targetUFR * weight) / (totalReplacement - fluidBalanceOpt); 
            preDilutionOpt = (plasmaFlow / A - plasmaFlow) * 60; 
            postDilutionOpt = totalReplacement - preDilutionOpt; 
            ffOpt = (postDilutionOpt - fluidBalanceOpt) / (plasmaFlow * 60) * 100; 
            const isReasonable = ffOpt < 30;

            let result = `<p><strong>ä¼˜åŒ–åå¤„æ–¹ï¼š</strong></p>`;
            result += `<ul>`;
            result += `<li>å‰ç¨€é‡Šç”¨é‡ï¼š${preDilutionOpt.toFixed(0)} ml/h</li>`;
            result += `<li>åç¨€é‡Šç”¨é‡ï¼š${postDilutionOpt.toFixed(0)} ml/h</li>`;
            result += `<li>æ»¤è¿‡åˆ†æ•°ï¼ˆFFï¼‰ï¼š${ffOpt.toFixed(1)}%</li>`;
            result += `</ul>`;
            result += isReasonable ? 
                `<p style="color: #27ae60; font-weight: bold;">âœ… å¤„æ–¹åˆç†ï¼šFFï¼œ30%ï¼Œç¬¦åˆå®‰å…¨æ ‡å‡†</p>` :
                `<p style="color: #e74c3c; font-weight: bold;">âŒ å¤„æ–¹ä¸åˆç†ï¼šFFâ‰¥30%ï¼Œè¡€æ¶²æµ“ç¼©ï¼Œæ»¤å™¨å‡è¡€é£é™©å¤§ï¼Œå»ºè®®è°ƒæ•´è¡€æµé€Ÿæˆ–ç½®æ¢æ¶²æ€»é‡ã€å¢åŠ å‰ç¨€é‡Šæ¯”ä¾‹ï¼</p>`;

            contentEl.innerHTML = result;
            resultEl.style.display = 'block';
        }

        function resetOptimizeCRRT() {
            document.getElementById('target-ufr').value = '';
            document.getElementById('total-replacement').value = '';
            document.getElementById('blood-flow-opt').value = '';
            document.getElementById('fluid-balance-opt').value = '';
            document.getElementById('optimize-result').style.display = 'none';
        }
    </script>
</body>
</html>